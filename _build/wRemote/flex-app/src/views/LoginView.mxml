<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
		xmlns:s="library://ns.adobe.com/flex/spark" title="Login"
		actionBarVisible="false" tabBarVisible="false"
		preinitialize="view_preinitializeHandler(event)">
	
	<fx:Script>
		<![CDATA[
			import connections.ServerConnection;
			
			import mx.events.FlexEvent;
			
			private var serverConnection:ServerConnection;
			
			protected function view_preinitializeHandler(event:FlexEvent):void
			{
				serverConnection = ServerConnection.getInstance();
			}
			
			protected function sendInformationButton_clickHandler(event:MouseEvent):void
			{
				var login:String = loginInput.text;
				var password:String = passwordInput.text;
				
				serverConnection.addEventListener(ServerConnection.SIGNIN_SUCCED, serverConnection_signinSuccess);
				serverConnection.addEventListener(ServerConnection.SIGNIN_FAILED, serverConnection_signinFail);
				serverConnection.signinRequest(login, password);
			}
			
			protected function serverConnection_signinSuccess(event:Event):void
			{
				serverConnection.removeEventListener(ServerConnection.SIGNIN_SUCCED, serverConnection_signinSuccess);
				serverConnection.removeEventListener(ServerConnection.SIGNIN_FAILED, serverConnection_signinFail);
				
				navigator.pushView(PlayView);
			}
			
			protected function serverConnection_signinFail(event:Event):void
			{
				serverConnection.removeEventListener(ServerConnection.SIGNIN_SUCCED, serverConnection_signinSuccess);
				serverConnection.removeEventListener(ServerConnection.SIGNIN_FAILED, serverConnection_signinFail);
			}
			
		]]>
	</fx:Script>
	
	<fx:Declarations>
		<!-- Placer ici les éléments non visuels (services et objets de valeur, par exemple). -->
	</fx:Declarations>
	
	<s:VGroup left="20" right="20" height="100%" width="100%"
			  horizontalAlign="center" verticalAlign="middle">
		
		<s:TextInput id="loginInput" prompt="Email ou Identifiant..." width="100%" height="40"
					 skinClass="skins.TextInputSkin" fontWeight="bold" color="0x505050"/>
		
		<s:TextInput id="passwordInput" prompt="Mot de passe..." width="100%" height="40"
					 skinClass="skins.TextInputSkin" fontWeight="bold" color="0x505050"
					 displayAsPassword="true"/>
		
		<s:Button id="sendInformationButton" label="Send"
				  skinClass="skins.ButtonSkin" width="40" height="40"
				  click="sendInformationButton_clickHandler(event)"/>
		
	</s:VGroup>
	
</s:View>
